{% extends "adminStaff/administrator.html" %}
{%block nav_admin_content%}

<div>
  <form class="well form-inline" id="school_email_send_form" method="POST" action="">
    {% csrf_token %}
    <div class="input-prepend">
      <span class="add-on"><i class="icon-envelope"></i></span>{{school_form.school_email}}
    </div>
    <div class="input-prepend">
      <span class="add-on"><i class="icon-th-large"></i></span>{{school_form.school_password}}
    </div>
    <div class="input-prepend">
      <span class="add-on"><i class="icon-user"></i></span>{{school_form.school_name}}
    </div>
    <div class="input-prepend">
      <span class="add-on"><i class="icon-th-large"></i></span>{{school_form.person_firstname}}
    </div>
    <span id="school_email_error_message"></span>
    <span class=" pull-right"><input type="button" class="btn btn-primary" id="email_to_school" onclick="send_email_to_school();" value="给学校发送邮件"/></span>
  </form><!--end school_email_send_form-->
  <table class="well table">
    <thead>
      <tr>
        <td><strong>已发送用户邮箱</strong></td>
        <td><strong>负责人</strong></td>
        <td><strong>用户权限</strong></td>
        <td><strong>用户状态</strong></td>
      </tr>
    </thead>
    <tbody>
      {%for user in email_list%}
      <tr>
        <td>{{user.email}}</td>
        <td>{{user.first_name}}</td>
        <td>{{user.auth}}</td>
        {%if user.is_active %}
        <td><button class="btn btn-success">已经激活</button></td>
        {%else%}
        <td><button class="btn btn-warning">已发送，尚未激活</button></td>
        {%endif%}
      </tr>
      {%endfor%}
    </tbody>
  </table>
	<div class="pagination pagination-right">
		<ul>
		{% if email_page.has_previous %}
      <li><a href="?page={{ email_page.previous_page_number }}" id="email-previous-page" arg="{{email_page.previous_page_number}}"><上一页</a></li>
		{% endif %}
		{% if not contain_begin %}
		<li><a href="?page=1">1</a></li>
	  <li><span>...</span></li>
		{% endif %}
		{% for index in index_list %}
			{% ifequal index email_page.number %}
				<li><span>{{ index }}</span></li>
			{% else %}
				<li><a href="?page={{ index }}">{{ index }}</a></li>
			{% endifequal %}
		{% endfor %}
		{% if not contain_end %}
    <li><span>...</span></li>
		<li><a href="?page={{ email_page.paginator.num_pages }}">{{ email_page.paginator.num_pages }}</a></li>
		{% endif %}
		{% if email_page.has_next %}
    <li><a href="?page={{ email_page.next_page_number }}" id="email-next-page" arg="{{email_page.next_page_number}}">下一页></a></li>
    {% endif %}
		</ul>
	</div>
</div>
<!-- ajax_csrf-->
<script type='text/javascript' src="{{STATIC_URL}}js/ajax_csrf.js"></script>
<!-- dajax-->
<script type='text/javascript' src="{{STATIC_URL}}js/adminstaff/send_email.js"></script>
{%endblock%}
