{% extends "school/home.html" %}
{%block nav_admin_content%}
<h3>
  项目列表
</h3>
{% if havedata_p %}
<form id="project_manage_form" method="POST" action="/school/" >
  {% csrf_token %}
  {{project_manage_form.project_grade}}
  {{project_manage_form.project_year}}
  <!-- {{project_manage_form.project_isover}} -->
  {{project_manage_form.project_overstatus}}
  <input type="submit" class="btn btn-primary" style="margin-bottom:10px;" id="filter_button" value="检索"/>
</form>
<div>
  <table class="table table-hover">
    <thead>
      <tr>
	<th>名称</th>
	<th>项目编号</th>
	<th>项目级别</th>
	<th>指导教师</th>
	<th>申请书</th>
	<th>中期检查表</th>
	<th>结题验收</th>
	<th>项目汇编</th>
	<th>是否结题</th>
	<th>查看过程记录</th>
      </tr>
    </thead>
    <tbody>
      {% for item in pro_list%}
      <tr>
	<td>{{item.title|truncatechars:15}}</td>
	<td>{{item.project_code}}</td>
	<td>{{item.project_grade}}</td>
	<td>{{item.adminuser}}</td>
	<td>
	  {% if item.file_application %}<span class="span label label-success">已上传</span>{% endif %}
          {% if not item.file_application %}<span class="span label label-important">未上传</span>{% endif %}
	</td>
	<td>
	  {% if item.file_interimchecklist %}<span class="span label label-success">已上传</span>{% endif %}
          {% if not item.file_interimchecklist %}<span class="span label label-important">未上传</span>{% endif %}
	</td>
	<td>
	  {% if item.file_summary %}<span class="span label label-success">已上传</span>{% endif %}
          {% if not item.file_summary %}<span class="span label label-important">未上传</span>{% endif %}
	</td>
	<td>
	  {% if item.file_projectcompilation %}<span class="span label label-success">已上传</span>{% endif %}
          {% if not item.file_projectcompilation %}<span class="span label label-important">未上传</span>{% endif %}
	</td>
	<td>
	  <!-- <input type="button" id="isover_button"  pid="{{item.project_id}}" rel="isover" {%if item.is_over %}value="打开项目" class="btn btn-primary"{%endif%}{%if not item.is_over%} class="btn btn-primary btn-warning" value="关闭项目"{%endif%}>  -->
          {%if item.is_showoverstatus%}
          <a data-toggle="modal" id="overstatus_{{item.project_id}}" onclick="get_subject_id('{{item.project_id}}')" href="#overstatus_choice"  pid="{{item.project_id}}" class="btn btn-primary">{{item.over_status}}</a>
          {% endif %}
	</td>
	<td>
      	  <span><a href="/school/processrecord_view/{{item.project_id}}" class='btn btn-primary'>过程记录管理</a></span>
  	</td>
      </tr>
      {%endfor%}
    </tbody>
  </table>
  <div class="modal hide fade" style="display: none;" id="overstatus_choice">
    <div class="modal-header">
      <a class="close" data-dismiss="modal">×</a>
      <h3>选择项目结题状态</h3>
    </div>
    <div class="modal-body">
      {{project_manage_form.project_overstatus}}
    </div>
    <div class="modal-footer">
      <a class="btn" data-dismiss="modal">关闭</a>
      <a class="btn btn-primary" data-dismiss="modal" onclick="project_overstatus();">保存更新</a>
    </div>
  </div>
</div>
{% else %}
目前没有进行中的项目或者项目未分级，请在查看项目等级设定界面查看是否有未分级项目<br>
<a type="button" class="btn btn-primary" href="/school/subject_rating">项目等级设定</a>
{% endif %}
<script type='text/javascript' src="{{STATIC_URL}}js/school/project_control.js"></script>
{%endblock%}
